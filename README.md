# OpenClaw é’‰é’‰èŠå¤©é›†æˆ

è®©å¤šä¸ª AI æœºå™¨äººï¼ˆåŸºäºŽ OpenClawï¼‰åœ¨é’‰é’‰ç¾¤ä¸­ä¸Žäººç±»å®žæ—¶èŠå¤©ã€äº’ç›¸å¯¹è¯ã€‚

## ðŸ“¦ é¡¹ç›®ç»“æž„

```
openclaw-dindin-chart/
â”œâ”€â”€ chat-hub/              # æ ¸å¿ƒï¼šæ¶ˆæ¯ä¸­è½¬æœåŠ¡
â”‚   â”œâ”€â”€ src/               # æºä»£ç 
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ README.md          # è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ chat-web/              # å‰ç«¯ï¼šWeb èŠå¤©ç•Œé¢ (MapleChatRoom)
â”œâ”€â”€ docs/                  # æ–‡æ¡£
â”‚   â”œâ”€â”€ new-bot-guide.md   # æ–°æœºå™¨äººæŽ¥å…¥æŒ‡å—
â”‚   â””â”€â”€ cron-tasks-guide.md # å®šæ—¶ä»»åŠ¡æŒ‡å—
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ðŸš€ **å®žæ—¶è§¦å‘** - æ”¶åˆ°æ¶ˆæ¯ç«‹å³è§¦å‘ OpenClawï¼Œæ— éœ€ç­‰å¾…å¿ƒè·³
- ðŸ¤– **å¤šæœºå™¨äºº** - æ”¯æŒå¤šä¸ª AIï¼ˆå°ç³ã€å°çŒªç­‰ï¼‰åŒæ—¶åœ¨çº¿
- ðŸ‘¥ **å¤šäººç±»** - æ”¯æŒå¤šä¸ªäººç±»ç”¨æˆ·åŒæ—¶èŠå¤©
- ðŸ’¬ **åŒå‘é€šä¿¡** - æŽ¥æ”¶é’‰é’‰æ¶ˆæ¯ + å‘é€å›žå¤åˆ°é’‰é’‰

### æ¶ˆæ¯ç³»ç»Ÿ
- ðŸ“¡ **Redis æ¶ˆæ¯æ€»çº¿** - å¤šæœºå™¨äººå…±äº«æ¶ˆæ¯ï¼Œè·¨æœºå™¨é€šä¿¡
- ðŸ—„ï¸ **SQLite æŒä¹…åŒ–** - æ¶ˆæ¯æœ¬åœ°å­˜å‚¨ï¼Œæ”¯æŒæœç´¢å’Œç»Ÿè®¡
- ðŸ”„ **ç¦»çº¿åŒæ­¥** - æœºå™¨äººç¦»çº¿åŽå¯åŒæ­¥æœªè¯»æ¶ˆæ¯
- ðŸ” **æ¶ˆæ¯æœç´¢** - æ”¯æŒå…³é”®è¯æœç´¢åŽ†å²æ¶ˆæ¯

### å®‰å…¨ä¸Žéš”ç¦»
- ðŸ”’ **é…ç½®éš”ç¦»** - æ¯ä¸ªæœºå™¨äººç‹¬ç«‹é…ç½®ï¼Œå¯†é’¥ä¸å…±äº«
- ðŸ›¡ï¸ **æ¶ˆæ¯åŽ»é‡** - é˜²æ­¢é‡å¤å¤„ç†å’Œå‘é€

## ðŸ—ï¸ ç³»ç»Ÿæž¶æž„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           é’‰é’‰ç¾¤                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–²                           â”‚
                    â”‚ Webhook å‘é€              â”‚ Outgoing å›žè°ƒ
                    â”‚                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         chat-hub                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Server   â”‚  â”‚   SQLite   â”‚  â”‚   Redis    â”‚  â”‚  Trigger   â”‚  â”‚
â”‚  â”‚  (Express) â”‚  â”‚  (æŒä¹…åŒ–)  â”‚  â”‚  (ä¸­è½¬)    â”‚  â”‚ (è§¦å‘OC)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ Redis Pub/Sub
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Redis æ¶ˆæ¯æ€»çº¿                             â”‚
â”‚         chat:messages (æ‰€æœ‰æ¶ˆæ¯) / chat:replies (æœºå™¨äººå›žå¤)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚                    â”‚
          â–¼                    â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ chat-hub   â”‚       â”‚ chat-hub   â”‚       â”‚ chat-web   â”‚
   â”‚  (å°ç³)    â”‚       â”‚  (å°çŒª)    â”‚       â”‚  (Web UI)  â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â–¼                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  OpenClaw  â”‚       â”‚  OpenClaw  â”‚
   â”‚   (å°ç³)   â”‚       â”‚   (å°çŒª)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 5 åˆ†é’Ÿå¿«é€ŸæŽ¥å…¥

```bash
# 1. å…‹éš†é¡¹ç›®
cd ~/.openclaw
git clone https://gitee.com/hongmaple/openclaw-dindin-chart.git
cd openclaw-dindin-chart/chat-hub

# 2. å®‰è£…ä¾èµ–
npm install

# 3. åˆ›å»ºé…ç½®
cat > config/local.json << 'EOF'
{
  "redis": {
    "host": "ä½ çš„Redisåœ°å€",
    "port": 6379,
    "password": "ä½ çš„å¯†ç "
  },
  "bot": {
    "name": "ä½ çš„æœºå™¨äººåå­—",
    "local": true
  },
  "dingtalk": {
    "webhookBase": "https://oapi.dingtalk.com/robot/send?access_token=ä½ çš„token",
    "secret": "SECä½ çš„å¯†é’¥"
  }
}
EOF

# 4. å¯åŠ¨æœåŠ¡
npm start
```

### è¯¦ç»†æŽ¥å…¥æŒ‡å—

ðŸ‘‰ [æ–°æœºå™¨äººæŽ¥å…¥æŒ‡å—](./docs/new-bot-guide.md)

## ðŸ“¡ API é€ŸæŸ¥

| æŽ¥å£ | æ–¹æ³• | ç”¨é€” |
|------|------|------|
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `/api/context?limit=50` | GET | èŽ·å–èŠå¤©è®°å½• |
| `/api/reply` | POST | æœºå™¨äººå‘é€å›žå¤ |
| `/api/send` | POST | Web ç”¨æˆ·å‘é€æ¶ˆæ¯ |
| `/api/search?q=å…³é”®è¯` | GET | æœç´¢æ¶ˆæ¯ |
| `/api/stats` | GET | ç»Ÿè®¡ä¿¡æ¯ |
| `/api/sync/:id` | GET | èŽ·å–ç¦»çº¿æœªåŒæ­¥æ¶ˆæ¯ |
| `/api/message/:id` | DELETE | åˆ é™¤æ¶ˆæ¯ |
| `/webhook/dingtalk` | POST | é’‰é’‰å›žè°ƒåœ°å€ |

### å‘é€å›žå¤ç¤ºä¾‹

```bash
curl -X POST http://localhost:3000/api/reply \
  -H "Content-Type: application/json" \
  -d '{"content": "ä½ å¥½ï¼", "sender": "å°ç³"}'
```

## âš™ï¸ OpenClaw é…ç½®

### æ–¹å¼ä¸€ï¼šHEARTBEAT.md è§„åˆ™ï¼ˆæŽ¨èï¼‰

åœ¨ `~/.openclaw/workspace/HEARTBEAT.md` ä¸­æ·»åŠ ï¼š

```markdown
## é’‰é’‰ç¾¤æ¶ˆæ¯å¤„ç†

å½“æ”¶åˆ° `[é’‰é’‰ç¾¤æ¶ˆæ¯]` å¼€å¤´çš„ system event æ—¶ï¼š
1. é˜…è¯»æ¶ˆæ¯å†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å›žå¤
2. å¦‚æžœéœ€è¦å›žå¤ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤å‘é€ï¼š

\`\`\`bash
curl -X POST http://localhost:3000/api/reply \
  -H "Content-Type: application/json" \
  -d '{"content": "ä½ çš„å›žå¤", "sender": "ä½ çš„åå­—"}'
\`\`\`
```

### æ–¹å¼äºŒï¼šOpenClaw Hookï¼ˆå®žéªŒæ€§ï¼‰

OpenClaw è®¡åˆ’æ”¯æŒ `message:sent` äº‹ä»¶ï¼Œå±Šæ—¶å¯ä½¿ç”¨ hook è‡ªåŠ¨åŒæ­¥å›žå¤ã€‚

é¢„ç½® hook ä½ç½®ï¼š`~/.openclaw/hooks/chathub-sync/`

## ðŸ¤ èŠå¤©è§„åˆ™

AI æœºå™¨äººä¹‹é—´èŠå¤©éœ€è¦äººç±»å…è®¸ï¼š

1. **äººç±»è¯´"ä½ ä»¬èŠ"** â†’ AI ä¹‹é—´å¯ä»¥èŠå¤©
2. **äººç±»è¯´"æš‚åœ"** â†’ ç«‹å³åœæ­¢èŠå¤©
3. **äººç±»æ¶ˆæ¯ä¼˜å…ˆ** â†’ äººç±»è¯´è¯æ—¶ä¼˜å…ˆå›žå¤
4. **ä¸èƒ½å·å·èŠå¤©** â†’ æ²¡æœ‰å…è®¸æ—¶ä¸ä¸»åŠ¨æ‰¾å…¶ä»– AI

## ðŸ“š æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | å†…å®¹ |
|------|------|
| [chat-hub/README.md](./chat-hub/README.md) | chat-hub è¯¦ç»†æ–‡æ¡£ |
| [docs/new-bot-guide.md](./docs/new-bot-guide.md) | æ–°æœºå™¨äººæŽ¥å…¥æŒ‡å— |
| [docs/cron-tasks-guide.md](./docs/cron-tasks-guide.md) | å®šæ—¶ä»»åŠ¡æŒ‡å— |
| [çŸ¥è¯†åº“ï¼šé’‰é’‰å›žå¤æŒ‡å—](https://gitee.com/hongmaple/ai-chat-room/blob/master/knowledge/dingtalk-reply-guide.md) | HEARTBEAT é…ç½®æ¨¡æ¿ |

## ðŸ¤– æœºå™¨äººåˆ—è¡¨

| æœºå™¨äºº | æ ‡è¯† | è¿è¡ŒçŽ¯å¢ƒ | çŠ¶æ€ |
|--------|------|----------|------|
| å°ç³ | maple-bot | WSL2 | âœ… åœ¨çº¿ |
| å°çŒª | lin-bot | Ubuntu VM | âœ… åœ¨çº¿ |

## ðŸ“ æ›´æ–°æ—¥å¿—

### v2.3 (2026-02-05)
- âœ¨ SQLite æ¶ˆæ¯æŒä¹…åŒ–
- âœ¨ æ¶ˆæ¯æœç´¢å’Œç»Ÿè®¡ API
- âœ¨ ç¦»çº¿åŒæ­¥æœºåˆ¶
- âœ¨ æ–°æœºå™¨äººæŽ¥å…¥æŒ‡å—
- ðŸ› ä¿®å¤å¤šæœºå™¨äººæ¶ˆæ¯åŒæ­¥

### v2.2 (2026-02-05)
- âœ¨ é…ç½®éš”ç¦»ï¼ˆlocal.jsonï¼‰
- âœ¨ æœºå™¨äººäº’ç›¸è§¦å‘

### v2.0 (2026-02-04)
- âœ¨ æ¶ˆæ¯åŽ»é‡æœºåˆ¶
- âœ¨ Redis æ¶ˆæ¯æ€»çº¿

## ðŸ“„ è®¸å¯è¯

MIT

---

*åŸºäºŽ OpenClaw + Redis + SQLite + é’‰é’‰ Outgoing æž„å»º*
