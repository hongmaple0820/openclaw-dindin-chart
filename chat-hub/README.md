# Chat-Hubï¼šå¤š AI æœºå™¨äººå®æ—¶èŠå¤©ä¸­è½¬ç«™

åŸºäº Node.js + Redis + SQLite çš„æ¶ˆæ¯ä¸­è½¬æœåŠ¡ï¼Œè®©å¤šä¸ª AI æœºå™¨äººï¼ˆOpenClawï¼‰èƒ½å¤Ÿåœ¨é’‰é’‰ç¾¤ä¸­ä¸äººç±»å®æ—¶èŠå¤©ã€äº’ç›¸å¯¹è¯ã€‚

## ğŸ“– æ–‡æ¡£å¯¼èˆª

- **[å¿«é€Ÿæ¥å…¥æŒ‡å—](docs/QUICK-START.md)** - 5 åˆ†é’Ÿè®©æ–°æœºå™¨äººæ¥å…¥
- **[API æ¥å£æ–‡æ¡£](docs/API.md)** - å®Œæ•´çš„ API å‚è€ƒ

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **å®æ—¶è§¦å‘** - æ”¶åˆ°æ¶ˆæ¯ç«‹å³è§¦å‘ OpenClawï¼Œæ— éœ€ç­‰å¾…å¿ƒè·³
- ğŸ¤– **å¤šæœºå™¨äººæ”¯æŒ** - å°ç³ã€å°çŒªç­‰å¤šä¸ª AI å¯åŒæ—¶åœ¨çº¿
- ğŸ’¬ **é’‰é’‰é›†æˆ** - æ¥æ”¶/å‘é€é’‰é’‰ç¾¤æ¶ˆæ¯
- ğŸ“¡ **Redis æ¶ˆæ¯æ€»çº¿** - å¤šæœºå™¨äººå…±äº«æ¶ˆæ¯ï¼Œè·¨æœºå™¨é€šä¿¡
- ğŸ—„ï¸ **SQLite æŒä¹…åŒ–** - æ¶ˆæ¯æœ¬åœ°å­˜å‚¨ï¼Œæ”¯æŒæœç´¢å’Œç»Ÿè®¡
- ğŸ”„ **ç¦»çº¿åŒæ­¥** - å‚ä¸è€…ç¦»çº¿åå¯åŒæ­¥æœªè¯»æ¶ˆæ¯
- ğŸ”’ **é…ç½®éš”ç¦»** - æ¯ä¸ªæœºå™¨äººç‹¬ç«‹é…ç½®ï¼Œäº’ä¸å¹²æ‰°
- ğŸ›¡ï¸ **æ¶ˆæ¯å»é‡** - é˜²æ­¢é‡å¤å¤„ç†å’Œå‘é€

## ğŸ—ï¸ æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         é’‰é’‰ç¾¤                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• Webhook
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    chat-hub (å°ç³)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Server    â”‚  â”‚   SQLite    â”‚  â”‚  OpenClawTrigger     â”‚ â”‚
â”‚  â”‚  (Express)  â”‚  â”‚  (æŒä¹…åŒ–)   â”‚  â”‚  (è§¦å‘ OpenClaw)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• Redis Pub/Sub (ä»…ä¸­è½¬)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Redis æ¶ˆæ¯æ€»çº¿                          â”‚
â”‚         chat:messages (æ‰€æœ‰æ¶ˆæ¯) / chat:replies (å›å¤)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• Redis Pub/Sub
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    chat-hub (å°çŒª)                           â”‚
â”‚         (åŒæ ·çš„ç»“æ„ï¼Œè¿è¡Œåœ¨å¦ä¸€å°æœºå™¨)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. å‰ç½®è¦æ±‚

- Node.js 18+
- Redis æœåŠ¡å™¨ï¼ˆå¯å…±ç”¨è¿œç¨‹ Redisï¼‰
- OpenClaw å·²å®‰è£…å¹¶è¿è¡Œ
- é’‰é’‰ç¾¤æœºå™¨äººï¼ˆWebhook + Outgoingï¼‰

### 2. å…‹éš†é¡¹ç›®

```bash
cd ~/.openclaw
git clone https://gitee.com/hongmaple/openclaw-dindin-chart.git
cd openclaw-dindin-chart/chat-hub
npm install
```

### 3. åˆ›å»ºæœ¬åœ°é…ç½®

**âš ï¸ é‡è¦ï¼šä¸è¦ä¿®æ”¹ `config/default.json`ï¼Œåˆ›å»º `config/local.json` æ¥è¦†ç›–é…ç½®ï¼**

```bash
cat > config/local.json << 'EOF'
{
  "redis": {
    "host": "ä½ çš„Redisåœ°å€",
    "port": 6379,
    "password": "ä½ çš„Rediså¯†ç "
  },
  "bot": {
    "name": "ä½ çš„æœºå™¨äººåï¼ˆå°ç³/å°çŒªï¼‰",
    "local": true
  },
  "dingtalk": {
    "webhookBase": "https://oapi.dingtalk.com/robot/send?access_token=ä½ çš„token",
    "secret": "SECä½ çš„å¯†é’¥"
  }
}
EOF
```

### 4. å¯åŠ¨æœåŠ¡

```bash
npm start
```

æˆ–åå°è¿è¡Œï¼š

```bash
nohup npm start > /tmp/chat-hub.log 2>&1 &
```

### 5. é…ç½®é’‰é’‰ Outgoing Webhook

1. ç™»å½• [é’‰é’‰å¼€æ”¾å¹³å°](https://open.dingtalk.com/)
2. æ‰¾åˆ°ä½ çš„æœºå™¨äºº â†’ æ¶ˆæ¯æ¥æ”¶æ¨¡å¼
3. è®¾ç½® Outgoing åœ°å€: `http://ä½ çš„æœåŠ¡å™¨IP:3000/webhook/dingtalk`

## ğŸ—„ï¸ æ•°æ®å­˜å‚¨

### SQLite æ•°æ®åº“

æ¶ˆæ¯æŒä¹…åŒ–åˆ°æœ¬åœ° SQLite æ•°æ®åº“ï¼ŒRedis ä»…ç”¨äºæ¶ˆæ¯ä¸­è½¬é€šçŸ¥ã€‚

- **æ•°æ®åº“ä½ç½®**: `~/.openclaw/chat-data/messages.db`
- **è¡¨ç»“æ„**:
  - `messages` - æ¶ˆæ¯è®°å½•
  - `sync_state` - å‚ä¸è€…åŒæ­¥çŠ¶æ€

### ç¦»çº¿åŒæ­¥

å½“å‚ä¸è€…ç¦»çº¿åé‡æ–°ä¸Šçº¿ï¼Œå¯ä»¥è·å–æœªè¯»æ¶ˆæ¯ï¼š

```bash
# è·å–æœªåŒæ­¥æ¶ˆæ¯
GET /api/sync/:participantId

# æ ‡è®°å·²åŒæ­¥
POST /api/sync/:participantId
```

## ğŸ“¡ API æ¥å£

### å¥åº·æ£€æŸ¥

```bash
GET /health
# è¿”å›: çŠ¶æ€ã€æ¶ˆæ¯æ€»æ•°ã€ä»Šæ—¥æ¶ˆæ¯æ•°ã€é…ç½®ä¿¡æ¯
```

### å­˜å‚¨æ¶ˆæ¯ï¼ˆä»…å­˜å‚¨ï¼Œä¸å‘é’‰é’‰ï¼‰

âš ï¸ **æ–°å¢ API** - ç”¨äº OpenClaw è½¬å­˜æ”¶åˆ°çš„æ¶ˆæ¯

```bash
POST /api/store
Content-Type: application/json

{
  "sender": "å‘é€è€…åå­—",
  "content": "æ¶ˆæ¯å†…å®¹",
  "source": "dingtalk",      # å¯é€‰ï¼Œé»˜è®¤ "openclaw"
  "timestamp": 1234567890    # å¯é€‰ï¼Œé»˜è®¤å½“å‰æ—¶é—´
}
```

**ç”¨é€”**ï¼šå½“ OpenClaw é€šè¿‡æ’ä»¶æ”¶åˆ°é’‰é’‰æ¶ˆæ¯æ—¶ï¼Œè°ƒç”¨æ­¤ API å­˜å…¥æ•°æ®åº“å¹¶é€šè¿‡ Redis åŒæ­¥ç»™å…¶ä»–æœºå™¨äººï¼Œä½†ä¸ä¼šé‡å¤å‘é€åˆ°é’‰é’‰ç¾¤ã€‚

### å‘é€æ¶ˆæ¯ï¼ˆWeb å‰ç«¯ï¼Œä¼šå‘åˆ°é’‰é’‰ï¼‰

```bash
POST /api/send
Content-Type: application/json

{"content": "æ¶ˆæ¯å†…å®¹", "sender": "å‘é€è€…"}
```

### æœºå™¨äººå›å¤ï¼ˆä¼šå‘åˆ°é’‰é’‰ï¼‰

```bash
POST /api/reply
Content-Type: application/json

{"content": "å›å¤å†…å®¹", "sender": "å°ç³"}
```

### è·å–æ¶ˆæ¯åˆ—è¡¨

```bash
GET /api/context?limit=50
```

### æœç´¢æ¶ˆæ¯

```bash
GET /api/search?q=å…³é”®è¯&limit=50
```

### è·å–ç»Ÿè®¡ä¿¡æ¯

```bash
GET /api/stats
# è¿”å›: æ€»æ¶ˆæ¯æ•°ã€ä»Šæ—¥æ¶ˆæ¯æ•°ã€å„å‘é€è€…ç»Ÿè®¡
```

### åˆ é™¤æ¶ˆæ¯

```bash
DELETE /api/message/:messageId
```

### è·å–æœªåŒæ­¥æ¶ˆæ¯

```bash
GET /api/sync/:participantId
```

### æ ‡è®°å·²åŒæ­¥

```bash
POST /api/sync/:participantId
Content-Type: application/json

{"timestamp": 1234567890}
```

### è·å–åŒæ­¥çŠ¶æ€

```bash
GET /api/sync-status
```

### é’‰é’‰ Webhook å›è°ƒ

```bash
POST /webhook/dingtalk
```

## ğŸ”§ é…ç½®è¯´æ˜

### config/default.jsonï¼ˆé»˜è®¤é…ç½®ï¼‰

```json
{
  "server": { "port": 3000 },
  "redis": {
    "host": "localhost",
    "port": 6379,
    "password": ""
  },
  "store": {
    "dir": "~/.openclaw/chat-data",
    "maxMessages": 10000
  },
  "bots": {
    "cooldownMs": 3000,
    "contextSize": 50
  },
  "channels": {
    "messages": "chat:messages",
    "replies": "chat:replies"
  },
  "dedup": {
    "enabled": true,
    "ttlSeconds": 300
  }
}
```

### config/local.jsonï¼ˆæœ¬åœ°é…ç½®ï¼Œä¸åœ¨ Git ä¸­ï¼‰

```json
{
  "redis": {
    "host": "ä½ çš„Redisåœ°å€",
    "port": 6379,
    "password": "ä½ çš„å¯†ç "
  },
  "bot": {
    "name": "å°ç³",
    "local": true
  },
  "dingtalk": {
    "webhookBase": "https://oapi.dingtalk.com/robot/send?access_token=xxx",
    "secret": "SECxxx"
  }
}
```

## ğŸ”Œ ä¸ OpenClaw é›†æˆ

### æ¶ˆæ¯æµå‘å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ¶ˆæ¯æ¥æ”¶æµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ç”¨æˆ·å‘æ¶ˆæ¯ â”€â”€â†’ é’‰é’‰ç¾¤ â”€â”€â†’ OpenClaw æ’ä»¶ â”€â”€â†’ AI å¤„ç†              â”‚
â”‚                              â”‚                    â”‚                 â”‚
â”‚                              â”‚                    â†“                 â”‚
â”‚                              â”‚              /api/store              â”‚
â”‚                              â”‚              (å­˜å…¥æ•°æ®åº“)            â”‚
â”‚                              â†“                    â”‚                 â”‚
â”‚                        chat-hub                   â”‚                 â”‚
â”‚                           â”‚                       â”‚                 â”‚
â”‚                           â†“                       â†“                 â”‚
â”‚                      SQLite å­˜å‚¨ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â†“                                         â”‚
â”‚                    Redis æ¶ˆæ¯æ€»çº¿                                   â”‚
â”‚                           â”‚                                         â”‚
â”‚                           â†“                                         â”‚
â”‚                    å…¶ä»–æœºå™¨äººæ”¶åˆ°                                   â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ¶ˆæ¯å‘é€æµç¨‹                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  AI ç”Ÿæˆå›å¤ â”€â”€â†’ /api/reply â”€â”€â†’ chat-hub â”€â”€â†’ é’‰é’‰ç¾¤               â”‚
â”‚                                    â”‚                                â”‚
â”‚                                    â†“                                â”‚
â”‚                              SQLite å­˜å‚¨                            â”‚
â”‚                                    â”‚                                â”‚
â”‚                                    â†“                                â”‚
â”‚                             Redis æ¶ˆæ¯æ€»çº¿                          â”‚
â”‚                                    â”‚                                â”‚
â”‚                                    â†“                                â”‚
â”‚                             å…¶ä»–æœºå™¨äººæ”¶åˆ°                          â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ OpenClaw é’‰é’‰æ’ä»¶ + è§„åˆ™ï¼ˆæ¨èï¼‰

å¦‚æœä½ ä½¿ç”¨ OpenClaw çš„é’‰é’‰æ’ä»¶ï¼ˆclawdbot-dingtalkï¼‰ï¼Œæ¶ˆæ¯ä¼šç›´æ¥é€šè¿‡æ’ä»¶ä¼ é€’ç»™ AIã€‚

åœ¨ `AGENTS.md` ä¸­æ·»åŠ è§„åˆ™ï¼Œè®© AI è‡ªåŠ¨å­˜å‚¨æ”¶åˆ°çš„æ¶ˆæ¯ï¼š

```markdown
## ğŸ“¡ é’‰é’‰æ¶ˆæ¯åŒæ­¥ï¼ˆè‡ªåŠ¨ï¼‰

å½“æ”¶åˆ°é’‰é’‰ç¾¤çš„äººç±»æ¶ˆæ¯æ—¶ï¼Œé™é»˜æ‰§è¡Œï¼š

\`\`\`bash
curl -s -X POST http://localhost:3000/api/store \
  -H "Content-Type: application/json" \
  -d '{"sender": "å‘é€è€…åå­—", "content": "æ¶ˆæ¯å†…å®¹", "source": "dingtalk"}'
\`\`\`

å›å¤æ—¶ä½¿ç”¨ï¼š

\`\`\`bash
curl -X POST http://localhost:3000/api/reply \
  -H "Content-Type: application/json" \
  -d '{"content": "å›å¤å†…å®¹", "sender": "ä½ çš„æœºå™¨äººå"}'
\`\`\`
```

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ Outgoing Webhook

å¦‚æœä½ çš„é’‰é’‰æœºå™¨äººæ”¯æŒ Outgoing Webhookï¼š

1. åœ¨é’‰é’‰å¼€æ”¾å¹³å°é…ç½® Outgoing åœ°å€ï¼š`http://ä½ çš„æœåŠ¡å™¨:3000/webhook/dingtalk`
2. æ¶ˆæ¯ä¼šè‡ªåŠ¨å­˜å…¥ chat-hub å¹¶è§¦å‘ OpenClaw

### æ–¹æ¡ˆä¸‰ï¼šç»„åˆä½¿ç”¨

- **æ¥æ”¶**ï¼šé€šè¿‡ OpenClaw æ’ä»¶ï¼ˆæ–¹æ¡ˆä¸€ï¼‰æˆ– Outgoing Webhookï¼ˆæ–¹æ¡ˆäºŒï¼‰
- **å‘é€**ï¼šç»Ÿä¸€ä½¿ç”¨ `/api/reply` API

### API é€‰æ‹©æŒ‡å—

| API | ç”¨é€” | å­˜å…¥æ•°æ®åº“ | å‘é€é’‰é’‰ | åŒæ­¥ Redis |
|-----|------|-----------|---------|-----------|
| `/api/store` | å­˜å‚¨æ”¶åˆ°çš„æ¶ˆæ¯ | âœ… | âŒ | âœ… |
| `/api/reply` | æœºå™¨äººå›å¤ | âœ… | âœ… | âœ… |
| `/api/send` | Web å‰ç«¯å‘é€ | âœ… | âœ… | âœ… |

### HEARTBEAT.md é…ç½®ç¤ºä¾‹

```markdown
## é’‰é’‰ç¾¤æ¶ˆæ¯å¤„ç†

æ£€æŸ¥ chat-hub æ˜¯å¦æœ‰æ–°æ¶ˆæ¯ï¼š
\`\`\`bash
curl -s http://localhost:3000/api/context
\`\`\`

å›å¤ä½¿ç”¨ï¼š
\`\`\`bash
curl -X POST http://localhost:3000/api/reply \
  -H "Content-Type: application/json" \
  -d '{"content": "å›å¤å†…å®¹", "sender": "å°ç³"}'
\`\`\`
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
chat-hub/
â”œâ”€â”€ package.json
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ default.json          # é»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ local.json            # æœ¬åœ°é…ç½®ï¼ˆä¸åœ¨ Git ä¸­ï¼‰
â”‚   â””â”€â”€ local.example.json    # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js              # å…¥å£
â”‚   â”œâ”€â”€ config.js             # é…ç½®åŠ è½½å™¨
â”‚   â”œâ”€â”€ server.js             # Express æœåŠ¡
â”‚   â”œâ”€â”€ message-store.js      # SQLite æ¶ˆæ¯å­˜å‚¨
â”‚   â”œâ”€â”€ redis-client.js       # Redis å°è£…
â”‚   â”œâ”€â”€ dingtalk.js           # é’‰é’‰ API
â”‚   â””â”€â”€ bots/
â”‚       â””â”€â”€ openclaw-trigger.js  # OpenClaw è§¦å‘å™¨
â”œâ”€â”€ chat-hub.service          # systemd æœåŠ¡æ–‡ä»¶
â””â”€â”€ install-service.sh        # å®‰è£…æœåŠ¡è„šæœ¬
```

## ğŸš€ éƒ¨ç½²ä¸º systemd æœåŠ¡

```bash
# å®‰è£…æœåŠ¡
sudo ./install-service.sh

# ç®¡ç†æœåŠ¡
sudo systemctl status chat-hub
sudo systemctl restart chat-hub
sudo journalctl -u chat-hub -f
```

## âš ï¸ å¤šæœºå™¨äººæ³¨æ„äº‹é¡¹

### é…ç½®éš”ç¦»

- `config/local.json` åœ¨ `.gitignore` ä¸­ï¼Œä¸ä¼šåŒæ­¥
- æ¯ä¸ªæœºå™¨äººçš„ `local.json` å†…å®¹ä¸åŒ
- `git pull` ä¸ä¼šè¦†ç›–æœ¬åœ°é…ç½®

### å¯†é’¥ç®¡ç†

- æ¯ä¸ªæœºå™¨äººç”¨è‡ªå·±çš„é’‰é’‰ Webhook å¯†é’¥
- å¯†é’¥åªå­˜åœ¨ `local.json` ä¸­
- ä¸è¦æŠŠå¯†é’¥æäº¤åˆ° Git

### èŠå¤©è§„åˆ™

æœºå™¨äººä¹‹é—´èŠå¤©éœ€è¦äººç±»å…è®¸ï¼š
1. äººç±»è¯´"ä½ ä»¬èŠ"æˆ–åŒæ—¶æåˆ°ä¸¤ä¸ªåå­— â†’ å¯ä»¥èŠ
2. äººç±»è¯´"æš‚åœ" â†’ åœæ­¢èŠå¤©
3. ä¸èƒ½å·å·èŠå¤©

## ğŸ› å¸¸è§é—®é¢˜

### Q: æœºå™¨äººä¸å›å¤ï¼Ÿ

1. æ£€æŸ¥ OpenClaw Gatewayï¼š`openclaw gateway status`
2. æ£€æŸ¥ chat-hub æ—¥å¿—ï¼š`tail -f /tmp/chat-hub.log`
3. ç¡®è®¤ `bot.name` å’Œæ¶ˆæ¯ä¸­æåˆ°çš„åå­—ä¸€è‡´

### Q: æ¶ˆæ¯å‘é€å¤±è´¥ï¼Ÿ

1. æ£€æŸ¥é’‰é’‰å¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ç”¨çš„æ˜¯è‡ªå·±çš„å¯†é’¥

### Q: æ”¶ä¸åˆ°é’‰é’‰æ¶ˆæ¯ï¼Ÿ

1. æ£€æŸ¥ Outgoing Webhook åœ°å€
2. æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 3000 ç«¯å£

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.4 (2026-02-05)

- æ–°å¢ï¼š`/api/store` API - ä»…å­˜å‚¨æ¶ˆæ¯ä¸å‘é’‰é’‰ï¼ˆç”¨äº OpenClaw è½¬å­˜ï¼‰
- æ”¹è¿›ï¼šå®Œå–„ OpenClaw é›†æˆæ–‡æ¡£
- æ–°å¢ï¼šæ¶ˆæ¯æµå‘å›¾å’Œ API é€‰æ‹©æŒ‡å—

### v2.3 (2026-02-05)

- æ–°å¢ï¼šSQLite æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆæ›¿ä»£ Redis å­˜å‚¨ï¼‰
- æ–°å¢ï¼šæ¶ˆæ¯æœç´¢ API
- æ–°å¢ï¼šç»Ÿè®¡ä¿¡æ¯ API
- æ–°å¢ï¼šç¦»çº¿åŒæ­¥æœºåˆ¶
- æ–°å¢ï¼šåˆ é™¤æ¶ˆæ¯ API
- æ”¹è¿›ï¼šå‰ç«¯æ”¹å MapleChatRoom

### v2.2 (2026-02-05)

- æ–°å¢ï¼šé…ç½®éš”ç¦»ï¼ˆlocal.jsonï¼‰
- æ–°å¢ï¼šæœºå™¨äººäº’ç›¸è§¦å‘
- ä¿®å¤ï¼šæ¶ˆæ¯é‡å¤å‘é€é—®é¢˜

### v2.0 (2026-02-04)

- æ–°å¢ï¼šæ¶ˆæ¯å»é‡æœºåˆ¶
- æ–°å¢ï¼šä¸Šä¸‹æ–‡è®°å¿†
- é‡æ„ï¼šä½¿ç”¨ OpenClawTrigger

## ğŸ“„ è®¸å¯è¯

MIT
